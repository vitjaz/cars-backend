generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

/**
  USER ENTITY
*/

enum UserType {
  CompanyUser
  IndividualUser
}

model User {
  id    Int     @id @default(autoincrement())
  email String  @unique
  type UserType
  createdAt DateTime @default(now())

  companyUser CompanyUser?
  individualUser IndividualUser?

  ads AD[]
  review Review[]
}
model CompanyUser {
  id Int     @id @default(autoincrement())
  user User @relation(fields: [userId], references: [id])
  userId Int @unique
  name String
  inn Int
  legalAddress String?
  phone String
}

model IndividualUser {
  id Int     @id @default(autoincrement())
  user User @relation(fields: [userId], references: [id])
  userId Int @unique
  firstName String
  lastName String
  phone String
}

// AD ENTITY
model AD {
  id Int @id @default(autoincrement())
  title String
  user User @relation(fields: [userId], references: [id])
  userId Int
  viewCount Int
  price Int
  desc String
  photoUrls String[]
  nationalNumber String
  year Int
  mileage Int
  vin String? @unique

  vehicle  Vehicle @relation(fields: [vehicleId], references: [id])
  vehicleId   Int
}

// VEHICLE ENTITY

enum VehicleType {
  AutoVehicle
  MotoVehicle
  SpecVehicle
}

enum DriveType {
  AWD
  FWD
  RWD
}

model Vehicle {
  id Int @id @default(autoincrement())
  name String
  weight Int // mm
  height Int // mm
  width Int // mm
  length Int // mm
  vehicleType VehicleType
  desc String
  engineCapacity Int // cm3
  isElectro Boolean
  driveType DriveType
  country         Country     @relation(fields: [countryId], references: [id])
  countryId       Int

  ads AD[]
  review Review[]
}

// COUNTRY

model Country {
  id Int @id @default(autoincrement())
  Code String
  Name String

  vehicles Vehicle[]
}

// REVIEW

model Review {
  id Int @id @default(autoincrement())
  title String
  desc String
  photoUrls String[]
  rating Int  // 1-5
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id])
  userId Int

  vehicle Vehicle @relation(fields: [vehicleId], references: [id])
  vehicleId Int
}